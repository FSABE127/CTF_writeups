1. Initial Scan and Enumeration Gainig the foothold.
```bash
┌──(sabeshan㉿kali)-[~]
└─$ nmap -sS -A -sV -sC -T4 10.201.81.143 -vv   
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-08 16:00 IST
NSE: Loaded 157 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 16:00
Completed NSE at 16:00, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 16:00
Completed NSE at 16:00, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 16:00
Completed NSE at 16:00, 0.00s elapsed
Initiating Ping Scan at 16:00
Scanning 10.201.81.143 [4 ports]
Completed Ping Scan at 16:00, 0.32s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 16:00
Completed Parallel DNS resolution of 1 host. at 16:00, 0.13s elapsed
Initiating SYN Stealth Scan at 16:00
Scanning 10.201.81.143 [1000 ports]
Discovered open port 135/tcp on 10.201.81.143
Discovered open port 80/tcp on 10.201.81.143
Discovered open port 445/tcp on 10.201.81.143
Discovered open port 139/tcp on 10.201.81.143
Discovered open port 3389/tcp on 10.201.81.143
Completed SYN Stealth Scan at 16:00, 16.81s elapsed (1000 total ports)
Initiating Service scan at 16:00
Scanning 5 services on 10.201.81.143
Completed Service scan at 16:00, 7.50s elapsed (5 services on 1 host)
Initiating OS detection (try #1) against 10.201.81.143
Retrying OS detection (try #2) against 10.201.81.143
Initiating Traceroute at 16:00
Completed Traceroute at 16:00, 3.02s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 16:00
Completed Parallel DNS resolution of 2 hosts. at 16:00, 6.61s elapsed
NSE: Script scanning 10.201.81.143.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 16:00
NSE Timing: About 99.86% done; ETC: 16:01 (0:00:00 remaining)
Completed NSE at 16:01, 40.15s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 16:01
Completed NSE at 16:01, 1.21s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 16:01
Completed NSE at 16:01, 0.04s elapsed
Nmap scan report for 10.201.81.143
Host is up, received echo-reply ttl 125 (0.30s latency).
Scanned at 2025-10-08 16:00:10 IST for 86s
Not shown: 995 filtered tcp ports (no-response)
PORT     STATE SERVICE       REASON          VERSION
80/tcp   open  http          syn-ack ttl 125 Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
135/tcp  open  msrpc         syn-ack ttl 125 Microsoft Windows RPC
139/tcp  open  netbios-ssn   syn-ack ttl 125 Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds  syn-ack ttl 125 Windows Server 2016 Standard Evaluation 14393 microsoft-ds
3389/tcp open  ms-wbt-server syn-ack ttl 125 Microsoft Terminal Services
|_ssl-date: 2025-10-08T10:32:18+00:00; +43s from scanner time.
| ssl-cert: Subject: commonName=Relevant
| Issuer: commonName=Relevant
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-10-07T10:29:12
| Not valid after:  2026-04-08T10:29:12
| MD5:   177c:b4ed:1f52:1f71:79c0:c5cd:25a0:6aa8
| SHA-1: f206:d2ec:2000:a99e:2618:430f:4e9b:882a:d423:19a2
| -----BEGIN CERTIFICATE-----
| MIIC1DCCAbygAwIBAgIQR3QTeFMcMYNFbMvAgaDHUTANBgkqhkiG9w0BAQsFADAT
| MREwDwYDVQQDEwhSZWxldmFudDAeFw0yNTEwMDcxMDI5MTJaFw0yNjA0MDgxMDI5
| MTJaMBMxETAPBgNVBAMTCFJlbGV2YW50MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
| MIIBCgKCAQEA3zWhklPJg2EShAP6lf/OfkTk2YG6yo/GAAaiUY9eHMvzMr44SsO7
| 0WoN3tTYzf+wuD2mKBxJSZ3B1ckRLe2BlyNAKCaCzRysUT14Mjm+ZeSNOoMiB+z7
| yXO2s/2DJ+l+gz2OVAXKFhf4E3ui/h7cube9FHrpX2U5ofZ5YojKNICVD0TMKKz+
| OEdXRFKgfflVVK/zC1UnKjyoREtAklSK3ezFqbh/Sr4I1IKxEp5tUGMdTKcymq6V
| OqBQjvdicGrxgIsSoDr9QOUPFIntrfOFg0sPDM4pyC4MzcQkn41ovWkmyi4A/xZs
| jo0HD0lfWkau1R4M1dz5HGrxTtDiBvTlawIDAQABoyQwIjATBgNVHSUEDDAKBggr
| BgEFBQcDATALBgNVHQ8EBAMCBDAwDQYJKoZIhvcNAQELBQADggEBAJGUTKAZkXD4
| 1xShJWB6aXGoJp9yYJSG4JufNoX+DZedfMl8yWZ/CPOJ3CcP14dYu5PBpYnnluel
| YTM8vaoCmcZdjxr28poPMWhWea0ERomeJAVHagWVhb4ukPTm+rICqoLmX9BeYQ4o
| 84IMLIRap2gjf9yiAbKUPwnBh+VVa+EtNzw+SrbRhQCBQ3HJxCJa7R2uCjm9p2bT
| 48QY56pG9ljW0j/NVIokmCgCqBfQT0EQGvI8XI3dPun0rWF0O094QNDs87FP4u4L
| +fWq0lSHhGAT6vHjjx1TqNEQWcKUB2K9Acltc+BZw3mXFa3nhRpxglnctWfdFLIi
| MUcr2M9/kxY=
|_-----END CERTIFICATE-----
| rdp-ntlm-info: 
|   Target_Name: RELEVANT
|   NetBIOS_Domain_Name: RELEVANT
|   NetBIOS_Computer_Name: RELEVANT
|   DNS_Domain_Name: Relevant
|   DNS_Computer_Name: Relevant
|   Product_Version: 10.0.14393
|_  System_Time: 2025-10-08T10:31:35+00:00
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2012|2016|2008|7 (91%)
OS CPE: cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7
OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
Aggressive OS guesses: Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2016 (91%), Microsoft Windows 7 or Windows Server 2008 R2 (85%)
No exact OS matches for host (test conditions non-ideal).
TCP/IP fingerprint:
SCAN(V=7.95%E=4%D=10/8%OT=80%CT=%CU=%PV=Y%DS=4%DC=T%G=N%TM=68E63D88%P=x86_64-pc-linux-gnu)
SEQ(SP=100%GCD=1%ISR=106%TI=I%II=I%SS=S%TS=A)
SEQ(SP=102%GCD=1%ISR=101%TI=I%TS=A)
OPS(O1=M508NW8ST11%O2=M508NW8ST11%O3=M508NW8NNT11%O4=M508NW8ST11%O5=M508NW8ST11%O6=M508ST11)
WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000)
ECN(R=Y%DF=Y%TG=80%W=2000%O=M508NW8NNS%CC=Y%Q=)
T1(R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=)
T2(R=N)
T3(R=N)
T4(R=N)
U1(R=N)
IE(R=Y%DFI=N%TG=80%CD=Z)

Uptime guess: 0.002 days (since Wed Oct  8 15:58:22 2025)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=256 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 58104/tcp): CLEAN (Timeout)
|   Check 2 (port 42862/tcp): CLEAN (Timeout)
|   Check 3 (port 55341/udp): CLEAN (Timeout)
|   Check 4 (port 59487/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2025-10-08T10:31:38
|_  start_date: 2025-10-08T10:29:12
| smb-os-discovery: 
|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)
|   Computer name: Relevant
|   NetBIOS computer name: RELEVANT\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2025-10-08T03:31:35-07:00
|_clock-skew: mean: 1h24m40s, deviation: 3h07m50s, median: 38s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

TRACEROUTE (using port 135/tcp)
HOP RTT       ADDRESS
1   323.35 ms 10.8.0.1
2   ... 3
4   323.78 ms 10.201.81.143

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 16:01
Completed NSE at 16:01, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 16:01
Completed NSE at 16:01, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 16:01
Completed NSE at 16:01, 0.00s elapsed
Read data files from: /usr/share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 87.34 seconds
           Raw packets sent: 2098 (96.138KB) | Rcvd: 127 (13.816KB)
```
---

2. The port 445 is open I checked for the anonymous login it's exist.
```bash
┌──(sabeshan㉿kali)-[~/thm/relevant]
└─$ smbclient  //10.201.81.143/nt4wrksv
Password for [WORKGROUP\sabeshan]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Sun Jul 26 03:16:04 2020
  ..                                  D        0  Sun Jul 26 03:16:04 2020
  passwords.txt                       A       98  Sat Jul 25 20:45:33 2020

                7735807 blocks of size 4096. 5125296 blocks available
smb: \> get passwords.txt
getting file \passwords.txt of size 98 as passwords.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
smb: \> exit
                                                                                                                              
┌──(sabeshan㉿kali)-[~/thm/relevant]
└─$ mousepad passwords.txt    
                                                                                                                              
┌──(sabeshan㉿kali)-[~/thm/relevant]
└─$ cat passwords.txt | base64 -d
base64: invalid input
                                                                                                                              
┌──(sabeshan㉿kali)-[~/thm/relevant]
└─$ cat passwords.txt            
[User Passwords - Encoded]
Qm9iIC0gIVBAJCRXMHJEITEyMw==
QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk
```
Bob - !P@$$W0rD!123
Bill - Juw4nnaM4n420696969!$$$

---
And manually check for the vulnerbility with nmap on ports 139 and 445.

```bash
┌──(sabeshan㉿kali)-[~/thm/relevant]
└─$ nmap --script vuln -p445,139 10.201.81.143 -vv 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-08 16:39 IST
NSE: Loaded 105 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 16:39
Completed NSE at 16:39, 10.02s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 16:39
Completed NSE at 16:39, 0.00s elapsed
Initiating Ping Scan at 16:39
Scanning 10.201.81.143 [4 ports]
Completed Ping Scan at 16:39, 0.37s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 16:39
Completed Parallel DNS resolution of 1 host. at 16:39, 0.04s elapsed
Initiating SYN Stealth Scan at 16:39
Scanning 10.201.81.143 [2 ports]
Discovered open port 139/tcp on 10.201.81.143
Discovered open port 445/tcp on 10.201.81.143
Completed SYN Stealth Scan at 16:39, 0.44s elapsed (2 total ports)
NSE: Script scanning 10.201.81.143.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 16:39
Completed NSE at 16:39, 19.02s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 16:39
Completed NSE at 16:39, 0.00s elapsed
Nmap scan report for 10.201.81.143
Host is up, received echo-reply ttl 125 (0.36s latency).
Scanned at 2025-10-08 16:39:36 IST for 20s

PORT    STATE SERVICE      REASON
139/tcp open  netbios-ssn  syn-ack ttl 125
445/tcp open  microsoft-ds syn-ack ttl 125

Host script results:
|_smb-vuln-ms10-054: false
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 16:39
Completed NSE at 16:39, 0.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 16:39
Completed NSE at 16:39, 0.00s elapsed
Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 30.44 seconds
           Raw packets sent: 6 (240B) | Rcvd: 3 (116B)
```

based on this we have remote code execution vulnerability is exists here I moved with these.

---

